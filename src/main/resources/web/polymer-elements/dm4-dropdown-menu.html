<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">

<dom-module id="dm4-dropdown-menu">

    <style>
        paper-button[active] {
            background-color: rgba(0, 0, 0, 0.25);
        }
        paper-menu {
            display: none;
            position: absolute;
            border: 1px solid lightgray;
        }
    </style>

    <template>
        <!-- Note: with Firefox the paper-button "noink" attribute causes constant high CPU load
        once the button is pressed -->
        <paper-button raised toggles on-tap="_buttonTap">{{label}}</paper-button>
        <paper-menu on-iron-select="_itemSelect">
            <content></content>
        </paper-menu>
    </template>

    <script>
        Polymer({
            is: "dm4-dropdown-menu",

            ready: function() {
                this.button = this.$$("paper-button");
                this.menu = this.$$("paper-menu");
            },

            _buttonTap: function(e) {
                if (this.button.active) {
                    this.menu.style.left = this.button.getBoundingClientRect().left + "px";
                    this._showMenu();
                } else {
                    this._hideMenu();
                }
            },

            _itemSelect: function() {
                this.button.active = false;
                this._hideMenu();
            },

            _showMenu: function() {
                this.menu.style.display = "block";
            },

            _hideMenu: function() {
                this.menu.style.display = "none";
            }
        });
    </script>

</dom-module>
